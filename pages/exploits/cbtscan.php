<?php include("../../header.php"); ?>
<div class="main-panel">
  <div class="content-wrapper">
    <div class="page-header">
      <h3 class="page-title"> CBT Exploit Scanner </h3>
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="#">Exploits</a></li>
          <li class="breadcrumb-item active" aria-current="page">CBT Exploit Scanner</li>
        </ol>
      </nav>
    </div>
    <div class="col-md-12 grid-margin stretch-card">
    <div class="card">
    <div class="card-body text-center">
    <div class="text-center mb-3">

    <h2>CBT Exploit Scanner</h2>
    	<form method="POST">
    	 <input type="text" name="url" class="form-control mb-3" placeholder="Enter Url">
    		<input type="submit" class="btn btn-outline-primary mb-3" value="Scan Exploit Candy CBT" name="cbtcandy">
    		<input type="submit" class="btn btn-outline-primary mb-3" value="Scan Exploit Beesmart CBT" name="cbtbeesmart">
    	</form>
      </div>
    <?php
    function curl($url){
    	$curl = curl_init();
    	curl_setopt($curl, CURLOPT_URL, $url);
    	curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
    	curl_setopt($curl, CURLOPT_HEADER, true);
    	$exe = curl_exec($curl);
    	$info = curl_getinfo($curl, CURLINFO_HTTP_CODE);
    	curl_close($curl);
    	return $info;
    }
    if (isset($_POST['url']) && !empty($_POST['url'])) {
    	$filter = htmlspecialchars($_POST['url']);
    	if(!preg_match('#^http(s)?://#',$filter)){
    		$web = "http://".$filter;
    	}
    	else {
    		$web = $filter;
    	}
    	$exp5 = $web."/admin/?pg=uplsiswa";
    	$exp6 = $web."/x-panel/?pg=banksoal&ac=lihat&id=990";
    	$candy = array('/plugins/uploadfile/demo/uploads/demo.html', '/plugins/uploadfile/demo/uploads/upload.php','/admin/filesoal.php','/admin/restore.php','/admin/soal/import_file.php','/admin/ifm.php');
    	$beesmart = array('/panel/pages/upload-file.php','/panel/pages/upload-logo.php','/panel/pages/upload_audio.php','/panel/pages/upload_video.php','/panel/pages/upload_gambar.php','/panel/pages/upload-fotosiswa.php','/panel/pages/upload-banner.php','/panel/pages/upload_jawab7.php','/panel/pages/upload_jawab6.php','/panel/pages/upload_jawab5.php','/panel/pages/upload_jawab2.php','/panel/pages/upload_jawab1.php');
    	if (isset($_POST['cbtcandy'])) {
    		if (curl($web."/admin/login.php") == "200") {
    			foreach ($candy as $key) {
    				$site = $web.$key;
    				if (curl($site) == "200") {
    					echo "Found : <a href='$site' target='_blank'>$site</a><br>";
    				}
    				else {
    					echo "Not Found : $site<br>";
    				}
    			}
    			if (curl($exp5) == "302") {
    				echo "Vuln : <a href='$exp5' target='_blank'>$exp5</a><br>";
    			}
    			else {
    				echo "Not Vuln : $exp5";
    			}
    			echo "";
    		}
    		else if(curl($web."/x-panel/login.php") == "200") {
    			if(curl($exp6) == "302"){
    				echo "Sql Injection With Sqlmap : <a href='$exp6' target='_blank'>$exp6</a><br>";
    			}
    			else {
    				echo "Not Injection : $exp6";
    			}
    		}
    		else {
    			echo "Not Candy CBT";
    		}
    	}
    	else if (isset($_POST['cbtbeesmart'])) {
    		if (curl($web."/panel/pages/login.php") == "200") {
    			foreach ($beesmart as $key) {
    				$site = $web.$key;
    				if (curl($site) == "200") {
    					echo "Found : <a href='$site' target='_blank'>$site</a><br>";
    				}
    				else {
    					echo "Not Found : $site<br>";
    				}
    			}
    		}
    		else {
    			echo "Not Beesmart CBT";
    		}
    	}
    }
    ?>

    </div>
    </div>
    </div>
<?php include("../../footer.php"); ?>
          <!-- partial -->
        </div>
        <!-- main-panel ends -->
      </div>
      <!-- page-body-wrapper ends -->
    </div>
    <!-- container-scroller -->
    <!-- plugins:js -->
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="../../assets/vendors/js/vendor.bundle.base.js"></script>
    <!-- endinject -->
    <!-- Plugin js for this page -->
    <!-- End plugin js for this page -->
    <!-- inject:js -->
    <script src="../../assets/js/off-canvas.js"></script>
    <script src="../../assets/js/hoverable-collapse.js"></script>
    <script src="../../assets/js/misc.js"></script>
    <script src="../../assets/js/settings.js"></script>
    <script src="../../assets/js/todolist.js"></script>
    <!-- endinject -->
  </body>
</html>
